#!/bin/sh

kanta_param() {
	case $1 in
		-*) echo $1;;
		*) KANTA_SEARCH=$1;;
	esac
}

if [ "_$1_" != "" ]; then
case $1 in
	-*)
		case $1 in
			*a) KANTA_FUNCTION=add;;
			*db:*) KANTA_FUNCTION=update;; #DB=?
			*del:*) KANTA_FUNCTION=remove;;
			*f:*) KANTA_FUNCTION=search;;
			*g) KANTA_FUNCTION=generate;;
			*i) KANTA_FUNCTION=add;;
			*s:*) KANTA_FUNCTION=search;;
			*st) KANTA_FUNCTION=status;;
			*t) KANTA_FUNCTION=status; KANTA_PARAM=TABLE;;
			*u) KANTA_FUNCTION=update;;
			*x) KANTA_FUNCTION=status; KANTA_PARAM=INDEX;;
		esac;;
	*) KANTA_FUNCTION=search; KANTA_SEARCH=$1;;
esac
	if [ "_$2_" != "" ]; then kanta_param $2; fi
else
	KANTA_FUNCTION=status
fi

if [ "_$(echo $DB)_" != "__" ]; then
	case $KANTA_FUNCTION in
		add) echo sqlite $DB insert $2 $3;;
		generate) echo sqlite $DB create table;;
		remove) echo sqlite $DB delete "(where $KANTA_SEARCH)";;
		search) echo sqlite $DB select FROM "(where $KANTA_SEARCH)";;
		status) if [ "_$(echo $KANTA_PARAM)_" != "__" ]; then sqlite3 $DB .schema|grep $KANTA_PARAM; else sqlite3 $DB .schema; fi;;
		update) echo sqlite $DB edit;;
	esac
else
	virhe DB $DB not defined
fi
